{% extends "base.html" %}

{% block title %}Dashboard - TBCV{% endblock %}

{% block content %}
<h1 style="margin-bottom: 30px;">TBCV Dashboard</h1>

<!-- Real-time Metrics Cards -->
<div class="metrics-grid">
    <div class="metric-card">
        <div class="metric-icon">üìã</div>
        <div class="metric-content">
            <div class="metric-label">Total Validations</div>
            <div class="metric-value" id="totalValidations">{{ stats.total_validations }}</div>
        </div>
    </div>

    <div class="metric-card">
        <div class="metric-icon">üí°</div>
        <div class="metric-content">
            <div class="metric-label">Total Recommendations</div>
            <div class="metric-value" id="totalRecommendations">{{ stats.total_recommendations }}</div>
        </div>
    </div>

    <div class="metric-card metric-pending">
        <div class="metric-icon">‚è≥</div>
        <div class="metric-content">
            <div class="metric-label">Pending Reviews</div>
            <div class="metric-value" id="pendingRecommendations">{{ stats.pending_recommendations }}</div>
        </div>
    </div>

    <div class="metric-card metric-success">
        <div class="metric-icon">‚úì</div>
        <div class="metric-content">
            <div class="metric-label">Accepted</div>
            <div class="metric-value" id="acceptedRecommendations">{{ stats.accepted_recommendations }}</div>
        </div>
    </div>

    <div class="metric-card metric-applied">
        <div class="metric-icon">üöÄ</div>
        <div class="metric-content">
            <div class="metric-label">Applied</div>
            <div class="metric-value" id="appliedRecommendations">{{ stats.applied_recommendations }}</div>
        </div>
    </div>

    <div class="metric-card metric-danger">
        <div class="metric-icon">‚úó</div>
        <div class="metric-content">
            <div class="metric-label">Rejected</div>
            <div class="metric-value" id="rejectedRecommendations">{{ stats.rejected_recommendations }}</div>
        </div>
    </div>
</div>

<!-- Live Activity Feed -->
<div class="card" style="margin-top: 30px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>Live Activity Feed</h2>
        <div class="connection-status">
            <span class="status-indicator" id="wsStatus"></span>
            <span id="wsStatusText">Connecting...</span>
        </div>
    </div>
    <div id="activityFeed" class="activity-feed">
        <div class="activity-item activity-placeholder">
            Waiting for activity...
        </div>
    </div>
</div>

<!-- Recent Validations -->
<div class="card" style="margin-top: 30px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>Recent Validations</h2>
        <a href="/dashboard/validations" class="btn btn-primary">View All</a>
    </div>

    {% if validations %}
    <table>
        <thead>
            <tr>
                <th>File Path</th>
                <th>Status</th>
                <th>Severity</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="recentValidations">
            {% for validation in validations %}
            <tr data-validation-id="{{ validation.id }}">
                <td class="truncate" title="{{ validation.file_path }}">{{ validation.file_path }}</td>
                <td><span class="badge badge-{{ validation.status }}">{{ validation.status }}</span></td>
                <td><span class="badge badge-{{ validation.severity }}">{{ validation.severity }}</span></td>
                <td>{{ validation.created_at }}</td>
                <td class="actions">
                    <a href="/dashboard/validations/{{ validation.id }}" class="btn btn-primary btn-sm">View</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>No recent validations</p>
    </div>
    {% endif %}
</div>

<!-- Pending Recommendations -->
<div class="card" style="margin-top: 30px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>Pending Recommendations</h2>
        <a href="/dashboard/recommendations?status=pending" class="btn btn-primary">View All</a>
    </div>

    {% if recommendations %}
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Type</th>
                <th>Confidence</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="pendingRecommendationsList">
            {% for rec in recommendations %}
            <tr data-recommendation-id="{{ rec.id }}">
                <td class="truncate" title="{{ rec.title }}">{{ rec.title }}</td>
                <td><span class="badge badge-secondary">{{ rec.type }}</span></td>
                <td>{{ "%.0f"|format(rec.confidence * 100) }}%</td>
                <td>{{ rec.created_at }}</td>
                <td class="actions">
                    <a href="/dashboard/recommendations/{{ rec.id }}" class="btn btn-primary btn-sm">Review</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>No pending recommendations</p>
    </div>
    {% endif %}
</div>

<!-- Admin Controls -->
<div class="card admin-controls" style="margin-top: 30px;">
    <h2 style="margin-bottom: 15px;">‚öôÔ∏è System Administration</h2>
    <div class="admin-grid">
        <div class="admin-action">
            <h3>üóëÔ∏è Delete All Workflows</h3>
            <p>Remove all workflow records from the database</p>
            <button onclick="confirmDelete('workflows')" class="btn btn-danger">Delete All Workflows</button>
        </div>
        <div class="admin-action">
            <h3>üìã Delete All Validations</h3>
            <p>Remove all validation results from the database</p>
            <button onclick="confirmDelete('validations')" class="btn btn-danger">Delete All Validations</button>
        </div>
        <div class="admin-action">
            <h3>üí° Delete All Recommendations</h3>
            <p>Remove all recommendations from the database</p>
            <button onclick="confirmDelete('recommendations')" class="btn btn-danger">Delete All Recommendations</button>
        </div>
        <div class="admin-action admin-action-danger">
            <h3>üîÑ Complete System Reset</h3>
            <p>Delete ALL data (workflows, validations, recommendations)</p>
            <button onclick="confirmSystemReset()" class="btn btn-danger btn-large">Reset Entire System</button>
        </div>
    </div>
</div>

<!-- Recent Workflows -->
<div class="card" style="margin-top: 30px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>Recent Workflows</h2>
        <a href="/dashboard/workflows" class="btn btn-primary">View All</a>
    </div>

    {% if workflows %}
    <table>
        <thead>
            <tr>
                <th>Type</th>
                <th>State</th>
                <th>Files</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for workflow in workflows %}
            <tr>
                <td>{{ workflow.type }}</td>
                <td><span class="badge badge-{{ workflow.state }}">{{ workflow.state }}</span></td>
                <td>{{ workflow.total_files or 0 }}</td>
                <td>{{ workflow.created_at }}</td>
                <td class="actions">
                    <a href="/dashboard/workflows/{{ workflow.id }}" class="btn btn-primary btn-sm">View</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>No recent workflows</p>
    </div>
    {% endif %}
</div>

<!-- Toast Container -->
<div id="toastContainer" class="toast-container"></div>

<script>
let ws = null;
let activityFeedItems = [];
const MAX_ACTIVITY_ITEMS = 20;

// Toast notification
function showToast(message, type = 'info', duration = 5000) {
    const container = document.getElementById('toastContainer');
    const toast = document.createElement('div');
    toast.className = `toast toast-${type} toast-enter`;

    const icon = {
        'success': '‚úì',
        'error': '‚úó',
        'warning': '‚ö†',
        'info': '‚Ñπ'
    }[type] || '‚Ñπ';

    toast.innerHTML = `
        <span class="toast-icon">${icon}</span>
        <span class="toast-message">${message}</span>
        <button class="toast-close" onclick="closeToast(this)">&times;</button>
    `;

    container.appendChild(toast);
    setTimeout(() => toast.classList.add('toast-show'), 10);
    setTimeout(() => closeToast(toast.querySelector('.toast-close')), duration);
}

function closeToast(btn) {
    const toast = btn.parentElement;
    toast.classList.remove('toast-show');
    toast.classList.add('toast-exit');
    setTimeout(() => toast.remove(), 300);
}

// Initialize WebSocket for real-time updates
function initWebSocket() {
    try {
        // Use correct protocol based on page protocol
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const wsUrl = `${protocol}//${window.location.host}/ws/validation_updates`;

        console.log('Connecting to WebSocket:', wsUrl);
        ws = new WebSocket(wsUrl);

        ws.onopen = function() {
            console.log('WebSocket connected successfully');
            updateConnectionStatus(true);
            showToast('Connected to live updates', 'success', 2000);
        };

        ws.onmessage = function(event) {
            try {
                const data = JSON.parse(event.data);
                console.log('Received update:', data);

                // Handle different message types
                if (data.type === 'heartbeat' || data.type === 'connection_established') {
                    console.log('WebSocket heartbeat/connection:', data.type);
                    return; // Don't process heartbeats as updates
                }

                handleUpdate(data);
            } catch (e) {
                console.error('Error processing WebSocket message:', e);
            }
        };

        ws.onclose = function(event) {
            console.log('WebSocket disconnected:', event.code, event.reason);
            updateConnectionStatus(false);
            // Reconnect after 5 seconds
            setTimeout(initWebSocket, 5000);
        };

        ws.onerror = function(error) {
            console.error('WebSocket error:', error);
            updateConnectionStatus(false);
        };
    } catch (error) {
        console.error('WebSocket init error:', error);
        updateConnectionStatus(false);
        // Retry connection after 5 seconds
        setTimeout(initWebSocket, 5000);
    }
}

// Update connection status
function updateConnectionStatus(connected) {
    const statusIndicator = document.getElementById('wsStatus');
    const statusText = document.getElementById('wsStatusText');

    if (connected) {
        statusIndicator.className = 'status-indicator status-connected';
        statusText.textContent = 'Live';
    } else {
        statusIndicator.className = 'status-indicator status-disconnected';
        statusText.textContent = 'Disconnected';
    }
}

// Handle incoming updates
function handleUpdate(data) {
    const type = data.type || 'unknown';
    const payload = data.data || data;

    // Update metrics
    updateMetrics();

    // Add to activity feed
    addActivityItem(type, payload);

    // Show toast notification
    const messages = {
        'validation_created': 'New validation created',
        'validation_approved': 'Validation approved',
        'validation_enhanced': 'Validation enhanced',
        'recommendation_created': 'New recommendation created',
        'recommendation_approved': 'Recommendation approved',
        'recommendation_applied': 'Recommendation applied'
    };

    const message = messages[type] || 'System update';
    showToast(message, 'info', 3000);

    // Update UI elements
    if (type.includes('validation')) {
        refreshRecentValidations();
    } else if (type.includes('recommendation')) {
        refreshPendingRecommendations();
    }
}

// Add activity item to feed
function addActivityItem(type, data) {
    const feed = document.getElementById('activityFeed');

    // Remove placeholder
    const placeholder = feed.querySelector('.activity-placeholder');
    if (placeholder) placeholder.remove();

    const item = document.createElement('div');
    item.className = 'activity-item activity-enter';

    const icon = getActivityIcon(type);
    const message = getActivityMessage(type, data);
    const time = new Date().toLocaleTimeString();

    item.innerHTML = `
        <span class="activity-icon">${icon}</span>
        <span class="activity-message">${message}</span>
        <span class="activity-time">${time}</span>
    `;

    feed.insertBefore(item, feed.firstChild);
    setTimeout(() => item.classList.add('activity-show'), 10);

    // Keep only recent items
    activityFeedItems.unshift(item);
    if (activityFeedItems.length > MAX_ACTIVITY_ITEMS) {
        const removed = activityFeedItems.pop();
        if (removed && removed.parentElement) {
            removed.remove();
        }
    }
}

// Get activity icon
function getActivityIcon(type) {
    const icons = {
        'validation_created': 'üìã',
        'validation_approved': '‚úì',
        'validation_rejected': '‚úó',
        'validation_enhanced': 'üöÄ',
        'recommendation_created': 'üí°',
        'recommendation_approved': '‚úì',
        'recommendation_rejected': '‚úó',
        'recommendation_applied': 'üéØ',
        'workflow_started': '‚ñ∂',
        'workflow_completed': '‚úì',
        'workflow_failed': '‚úó'
    };
    return icons[type] || '‚Ä¢';
}

// Get activity message
function getActivityMessage(type, data) {
    const validation_id = data.validation_id || data.id || 'Unknown';
    const file_path = data.file_path ? data.file_path.split('/').pop() : '';

    const messages = {
        'validation_created': `New validation created: ${file_path}`,
        'validation_approved': `Validation approved: ${file_path}`,
        'validation_rejected': `Validation rejected: ${file_path}`,
        'validation_enhanced': `Validation enhanced: ${file_path}`,
        'recommendation_created': `New recommendation created`,
        'recommendation_approved': `Recommendation approved`,
        'recommendation_rejected': `Recommendation rejected`,
        'recommendation_applied': `Recommendation applied`,
        'workflow_started': `Workflow started`,
        'workflow_completed': `Workflow completed`,
        'workflow_failed': `Workflow failed`
    };

    return messages[type] || `System update: ${type}`;
}

// Update metrics via polling
async function updateMetrics() {
    try {
        const response = await fetch('/api/stats');
        if (response.ok) {
            const stats = await response.json();

            animateValue('totalValidations', parseInt(document.getElementById('totalValidations').textContent), stats.total_validations || 0);
            animateValue('totalRecommendations', parseInt(document.getElementById('totalRecommendations').textContent), stats.total_recommendations || 0);
            animateValue('pendingRecommendations', parseInt(document.getElementById('pendingRecommendations').textContent), stats.pending_recommendations || 0);
            animateValue('acceptedRecommendations', parseInt(document.getElementById('acceptedRecommendations').textContent), stats.accepted_recommendations || 0);
            animateValue('appliedRecommendations', parseInt(document.getElementById('appliedRecommendations').textContent), stats.applied_recommendations || 0);
            animateValue('rejectedRecommendations', parseInt(document.getElementById('rejectedRecommendations').textContent), stats.rejected_recommendations || 0);
        }
    } catch (error) {
        console.error('Error updating metrics:', error);
    }
}

// Animate number change
function animateValue(elementId, start, end, duration = 500) {
    const element = document.getElementById(elementId);
    if (!element || start === end) return;

    const range = end - start;
    const increment = range / (duration / 16); // 60fps
    let current = start;

    const timer = setInterval(() => {
        current += increment;
        if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
            element.textContent = end;
            clearInterval(timer);
        } else {
            element.textContent = Math.floor(current);
        }
    }, 16);
}

// Refresh recent validations
async function refreshRecentValidations() {
    try {
        const response = await fetch('/api/validations?limit=10');
        if (response.ok) {
            const validations = await response.json();
            const tbody = document.getElementById('recentValidations');
            if (tbody && validations.length > 0) {
                // Update would go here - simplified for now
                updateMetrics();
            }
        }
    } catch (error) {
        console.error('Error refreshing validations:', error);
    }
}

// Refresh pending recommendations
async function refreshPendingRecommendations() {
    try {
        const response = await fetch('/api/recommendations?status=pending&limit=10');
        if (response.ok) {
            const recommendations = await response.json();
            const tbody = document.getElementById('pendingRecommendationsList');
            if (tbody && recommendations.length > 0) {
                // Update would go here - simplified for now
                updateMetrics();
            }
        }
    } catch (error) {
        console.error('Error refreshing recommendations:', error);
    }
}

// Admin functions for delete operations
async function confirmDelete(type) {
    const messages = {
        'workflows': 'Are you sure you want to delete ALL workflows? This action cannot be undone.',
        'validations': 'Are you sure you want to delete ALL validations? This action cannot be undone.',
        'recommendations': 'Are you sure you want to delete ALL recommendations? This action cannot be undone.'
    };

    if (!confirm(messages[type])) {
        return;
    }

    try {
        let endpoint;
        let requestOptions = {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
        };

        if (type === 'workflows') {
            endpoint = '/api/workflows/delete-all?confirm=true';
            requestOptions.method = 'DELETE';
        } else if (type === 'validations') {
            // Use system reset with only validations
            endpoint = '/api/admin/reset';
            requestOptions.body = JSON.stringify({
                confirm: true,
                delete_validations: true,
                delete_workflows: false,
                delete_recommendations: false,
                delete_audit_logs: false,
                clear_cache: false
            });
        } else if (type === 'recommendations') {
            // Use system reset with only recommendations
            endpoint = '/api/admin/reset';
            requestOptions.body = JSON.stringify({
                confirm: true,
                delete_validations: false,
                delete_workflows: false,
                delete_recommendations: true,
                delete_audit_logs: false,
                clear_cache: false
            });
        }

        const response = await fetch(endpoint, requestOptions);
        const result = await response.json();

        if (response.ok) {
            showToast(`Successfully deleted all ${type}`, 'success');
            // Refresh the page after a short delay
            setTimeout(() => location.reload(), 1500);
        } else {
            showToast(`Failed to delete ${type}: ${result.detail || 'Unknown error'}`, 'error');
        }
    } catch (error) {
        console.error(`Error deleting ${type}:`, error);
        showToast(`Error deleting ${type}: ${error.message}`, 'error');
    }
}

async function confirmSystemReset() {
    const confirmed = confirm(
        '‚ö†Ô∏è DANGER: This will DELETE ALL DATA from the system!\n\n' +
        'This includes:\n' +
        '‚Ä¢ All workflows\n' +
        '‚Ä¢ All validations\n' +
        '‚Ä¢ All recommendations\n' +
        '‚Ä¢ Cache data\n\n' +
        'This action CANNOT be undone!\n\n' +
        'Are you absolutely sure?'
    );

    if (!confirmed) {
        return;
    }

    // Double confirmation for safety
    const doubleConfirm = confirm('This is your last chance. Are you REALLY sure you want to reset the entire system?');
    if (!doubleConfirm) {
        return;
    }

    try {
        const response = await fetch('/api/admin/reset', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                confirm: true,
                delete_validations: true,
                delete_workflows: true,
                delete_recommendations: true,
                delete_audit_logs: false,
                clear_cache: true
            })
        });

        const result = await response.json();

        if (response.ok) {
            const totalDeleted = Object.values(result.deleted || {}).reduce((a, b) => a + b, 0);
            showToast(`System reset complete! Deleted ${totalDeleted} items`, 'success', 3000);
            // Refresh the page after a delay
            setTimeout(() => location.reload(), 2000);
        } else {
            showToast(`System reset failed: ${result.detail || 'Unknown error'}`, 'error');
        }
    } catch (error) {
        console.error('Error resetting system:', error);
        showToast(`Error resetting system: ${error.message}`, 'error');
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    initWebSocket();

    // Poll metrics every 30 seconds
    setInterval(updateMetrics, 30000);
});
</script>

<style>
/* Metrics Grid */
.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.metric-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
}

.metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.metric-icon {
    font-size: 36px;
}

.metric-content {
    flex: 1;
}

.metric-label {
    font-size: 12px;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 5px;
}

.metric-value {
    font-size: 28px;
    font-weight: bold;
    color: #333;
}

.metric-pending {
    border-left: 4px solid #ffc107;
}

.metric-success {
    border-left: 4px solid #28a745;
}

.metric-applied {
    border-left: 4px solid #17a2b8;
}

.metric-danger {
    border-left: 4px solid #dc3545;
}

/* Connection Status */
.connection-status {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: #666;
}

.status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

.status-connected {
    background: #28a745;
}

.status-disconnected {
    background: #dc3545;
    animation: none;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* Activity Feed */
.activity-feed {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    background: #f8f9fa;
}

.activity-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-bottom: 1px solid #dee2e6;
    background: white;
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.3s ease;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-enter {
    animation: slideDown 0.3s ease forwards;
}

.activity-show {
    opacity: 1;
    transform: translateY(0);
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.activity-placeholder {
    color: #999;
    text-align: center;
    font-style: italic;
}

.activity-icon {
    font-size: 20px;
}

.activity-message {
    flex: 1;
    font-size: 14px;
}

.activity-time {
    font-size: 12px;
    color: #999;
}

/* Toast Notifications */
.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 400px;
}

.toast {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    background: white;
    border-left: 4px solid;
    opacity: 0;
    transform: translateX(400px);
    transition: all 0.3s ease;
}

.toast-enter {
    animation: slideIn 0.3s ease forwards;
}

.toast-show {
    opacity: 1;
    transform: translateX(0);
}

.toast-exit {
    animation: slideOut 0.3s ease forwards;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateX(400px); }
    to { opacity: 1; transform: translateX(0); }
}

@keyframes slideOut {
    from { opacity: 1; transform: translateX(0); }
    to { opacity: 0; transform: translateX(400px); }
}

.toast-success {
    border-left-color: #28a745;
    background: #d4edda;
}

.toast-error {
    border-left-color: #dc3545;
    background: #f8d7da;
}

.toast-warning {
    border-left-color: #ffc107;
    background: #fff3cd;
}

.toast-info {
    border-left-color: #17a2b8;
    background: #d1ecf1;
}

.toast-icon {
    font-size: 20px;
    font-weight: bold;
}

.toast-message {
    flex: 1;
    font-size: 14px;
}

.toast-close {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    opacity: 0.5;
    transition: opacity 0.2s;
}

.toast-close:hover {
    opacity: 1;
}

/* Admin Controls */
.admin-controls {
    background: #fff9e6;
    border: 2px solid #ffc107;
    border-radius: 12px;
}

.admin-controls h2 {
    color: #856404;
    font-size: 20px;
}

.admin-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.admin-action {
    background: white;
    border-radius: 8px;
    padding: 20px;
    border: 2px solid #dee2e6;
    transition: all 0.2s;
}

.admin-action:hover {
    border-color: #dc3545;
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.15);
}

.admin-action h3 {
    font-size: 16px;
    margin: 0 0 10px 0;
    color: #333;
}

.admin-action p {
    font-size: 13px;
    color: #666;
    margin: 0 0 15px 0;
    line-height: 1.4;
}

.admin-action-danger {
    border-color: #dc3545;
    background: #fff5f5;
}

.admin-action-danger h3 {
    color: #dc3545;
}

.btn-danger {
    background: #dc3545;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    font-weight: 500;
}

.btn-danger:hover {
    background: #c82333;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
}

.btn-danger:active {
    transform: translateY(0);
}

.btn-large {
    padding: 12px 24px;
    font-size: 15px;
    font-weight: 600;
}
</style>

{% endblock %}
